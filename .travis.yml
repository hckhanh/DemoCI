language: android

branches:
  only:
    - master

git:
  depth: 1

notifications:
  email: false

env:
  global:
    # General information:
    - ANDROID_ABI=armeabi-v7a # x86 or armeabi-v7a. At this time, Travis can not run android-x86
    - ANDROID_TARGET=android-22

    # Android project configurations:
    - ANDROID_DIR=Client/Client.Android
    - ANDROID_PROJECT_NAME=DemoApps
    - BUILD_TYPE=travisCI
    - RELEASE_PATH_FILE=build/outputs/apk
    # - NODE_JS_APP_NAME=N/A

    # Android apps information:

    # ANDROID_STORE_PASS
    - secure: LOu8e42oVc40nHgl7OE02t3nQTxLAENmVf4RqYInn9UTOPPi5+k9qL4/ixwTvQ6UVxeIE1h34kMG/9Cl7Gl3+K+s2hu4NNCcFhUF7QG0bjABeR6pNJ7mwutllE6BIh/GLnkbD88mUKDZja72Y9MlAOgaZclj0JYf46YiXm6nRDvcUoVBQQ8Qlp8nC+SaaGMGgWLQ0qdHdFARUMICFyE5OUISq4KQoUsw5VzryvccWDFgseO6AOVpKEKeYTq7FjZ/VRk8UhGcptYy/OckECowXFZ0iI0wUKB3t7En7E6e5XX1uX0OppMNDbvne4hDeXRn4m1zUr2Tfb/LtXNMko7bV/XRssShmJjNHQtgtqoUF5hmikOT66Epeu3Qu1Q58ZzNTBGcM8uM6oeIXrDkyAU9WjUY1sq3hrlWufnFkeGQgjrq74FhXwaYuEyinPe3RGSmxlUEqUsw1mc1RJ13ZFAY+A8P8EDsssp3XtZHIn6cRjn/L5NsYUpfQD7B7gr9okWHiVebuG8Q8wig20YXv/eDUuIQ3EHt85zJCw6oB2rIByyHCgOdUZdSaDGq4SaQTaTxGZf0DlWINSrGSGqeYF3yk6kUU0CFUSRYyRK74G1Wv5yGjf1Wt8MUwGodNaZTuD+eeZOmsPXm9CvADa4AfEUqP1DpFhIchhHIFbPEB6kMAtE=

    ##### Android App 1 #####

    - ANDROID_APP1_NAME=DemoApp1
    - ANDROID_APP1_MODULE_NAME=app1
    # ANDROID_APP1_KEY_PASS
    - secure: he8XgGH+Y4plEK6flNQmVuvJ0SC01r7rEM5ZufkXnbTASCXmGwSyPFrmV23cBBK8gRvv2lMD+1AwOlgLabIukUBp5XwZI4Z5kxmiPg2kYjrHFr8YcFS82Tb1K0h3ZrAu1ERMR5sTal3YuGwmpmLKlcxNvyVjKBn0jyzbDtmUHEjJs+hcb9CSKg2xy/Ka1hp2f8eJNAa2dAZyJIdPoTm+TAQajDsx+vGTN20XfyMlFCv2Uj2hPiVndCgnkZBuvw/9zQKI2Pt2g+SVlB7DC7TJkFJKxgDQ5xhGP1hKHv2HQ8VgNJSN4HBYd3LMS8zN8fHRmCiVfOaaju7Zq+TkylHhYVLuslGBauUhSqsscnQQRHNTMRkrc2OgJn5rjVCbLEtMhFk2eYbsZ6mmSOXGhxjbYaGyHhqJoCOM45Dfpb+maShWxrrr18b1ydLfU73ggH6zjsKSxcXC3LYEWN1rMAAND3eU3I98r/AsszPJhsxU1rmVSn1Ip0zbUX0mBZW9z4vnOt4tHsx5L90T772sMU2keBXBeJcl+f2fljdi9diDnOmM6H5rSZHutUuRtRKjm0U898vEQy9/mLiw8FuRf8XBaX5voozRwuBeKwDLGhl2hsPQo9tT95/dj8SLHGH/s99T+hQSXAjJrLAElLmQA3HitrJkE+rdQWJszDAoqmFKVZ4=

    ##### Android App 2 #####

    - ANDROID_APP2_NAME=DemoApp2
    - ANDROID_APP2_MODULE_NAME=app2
    # ANDROID_APP2_KEY_PASS
    - secure: fgcnJlQroUPF/A6jfznnUkLm0CBgD8FWIpL2Bd83fNcm2MnVmWPmVbivJmd0XEnEAdWEgkXUp+858Utk/1Encg6DEl2JYGI8yHhjftH9+NUUBwqc0yk4WZbFDEAwi4DWKuoPMpD5UL2vc2VZGKOU9TUryEQtVvr7yp6enF24qUyD7s2JHcXc/zC2+ai1P+WOJ3yUL8SDO4G3wRwCmURmf4mdCdVlxv3SaBgOQPA/0VNVx1kKFpKZ8czhb8eWJ4QaIqkE7aXaGg3Ss8fap+ftsITZpcAXiWI7g7BXzgqhA50Rw4mtTNz4n9lc1QQBidQLeh8Gy2DvQCwXMK5H2Ws1/sq2QXsyrtXQ9MpF0GZkbGMaLG+R9AG3ZV4fvdXt6IBIzMM4DklvwU8FeQFawQJMG4PlN2NVLAj6XIvjxypiDSF51+3163OGojaZI4PL4mEf5EVvTgpIP/0vjfVjHkCLRDegdIxT/vgJfSpMfFiKTYEZhl5SdYAIIxGPlYyGgpS3pBbZi6cWu8vuY9H/edOjIskfmb3OfY+er2yO/FjO1kkaGgSKbVUf6t5blCK4UzyILvaD0L97FsXk019J0G0YJGcZ3bPtUAViu423Ng7bip69Yu1bEvlkT9rBOu8sqqQV4n3PtPnxPTeM6hqIRiX5sIf0o1T0jPyu799SXQXAlLo=

  matrix:
    # Use these env variables to run test on Travis:
    #   ANDROID_APP1
    #   ANDROID_APP2
    #   NODE_JS_SERVER
    # - ANDROID_APP1=connectedCheck
    - ANDROID_APP1=true
    - ANDROID_APP2=true
    # - NODE_JS_SERVER=test

    # Test for multiple API (NOT work)
    # - ANDROID_TARGET=android-15 ANDROID_ABI=armeabi-v7a
    # - ANDROID_TARGET=android-19 ANDROID_ABI=armeabi-v7a
    # - ANDROID_TARGET=android-22 ANDROID_ABI=armeabi-v7a

android:
  components:
    # Uncomment the lines below if you want to
    # use the latest revision of Android SDK Tools
    - platform-tools
    - tools

    # The BuildTools version used by your project
    - build-tools-22.0.1

    # The SDK version used to compile your project
    - $ANDROID_TARGET

    # Additional components
    - extra-google-google_play_services
    - extra-google-m2repository
    - extra-android-m2repository

    # Specify at least one system image,
    # if you need to run emulator(s) during your tests
    - sys-img-$ANDROID_ABI-$ANDROID_TARGET

before_install:
  - chmod -R ugo+x travis-script/
  - source ./travis-script/install-dependencies.sh

script:
  # Run Android and/or Node.js test cases
  - ./travis-script/run-test-cases.sh

before_deploy:
  # Generate relesea files to publish to GitHub
  - ./travis-script/generate-signed-apks.sh

#deploy:
#  provider: releases
#  api_key:
#    secure: NWsgjZ+h3uQ2xMlwcsrpwWOecrY4ExIbZjWQm6fMnWSENpz1Oy1vOTTlUJMFfjZc9kbOTF5a7qFPr/kJlEDuygpNNXqUMy/IZhxqX/T81RJF7CZN/sL3MorE/w77EPxZBbhDekf20xc1zWfDE5Wa4jTX3SevNffWHLXflmmgxCToettIP9yu2JU4tJeqx6jRA3aTMbUt32tPU+uKocxkNAmWLz4QCbVZgs16KqhUuUec3FjrDfcvkSE6mHQIIdlRZMQFUhsWJF5k4Fimp1XESmdByr58ugDn7NS8orWJAbeWRf4QspOicCBezjNtM/jk4iS7ciNNP4MAp03NDgkK9O/eqQ1LJIR10UxqfKK/njCkVFO1JOmIpU3QqoRNwB5OY1gpY2zrCFi6A0SlOpIMeOlEq7+S7P5xl5/eZbJL2xN9OxfsyJniGfaKsm1k+JLfvRH9ZVuu1dvem9LlBdzFhku2FJmMXfaaCJcpWJ5YWfrCSLHChVatehTFX13pr7kKbJ5IrQmlR2o7BEEXyi8QWfVWaeF9e1LOhfguq/oHvxY/YkFLeVsNmrtD5ZhlWd3uBDlX0OjniD1cbiScqjDYbmoQxvjhs2UZzvQEsyB6YIw4x06iuk2/igS/9S8mg/Kgh23ivp5lFIBhDkRJujNbWNxSpPvoToP8sXckwzNDLJw=
#  file:
#    - ./$ANDROID_DIR/$ANDROID_PROJECT_NAME/$ANDROID_APP1_MODULE_NAME/$RELEASE_PATH_FILE/$ANDROID_APP1_NAME-$TRAVIS_TAG.apk
#    - ./$ANDROID_DIR/$ANDROID_PROJECT_NAME/$ANDROID_APP2_MODULE_NAME/$RELEASE_PATH_FILE/$ANDROID_APP2_NAME-$TRAVIS_TAG.apk
#  skip_cleanup: true
#  on:
#    tags: true
#    branch: master
